/* eslint-disable no-sparse-arrays */
type TextEncodingUnicode = number | undefined;
interface TextEncodingTable {
  [key: number]: [
    TextEncodingUnicode,
    TextEncodingUnicode,
    TextEncodingUnicode,
    string
  ];
}

export enum TextEncodingEnum {
  StandardEncoding,
  MacRomanEncoding,
  WinAnsiEncoding
}

export class TextEncoding {
  private static table: TextEncodingTable = {
    // index: [StandardEncoding, MacRomanEncoding, WinAnsiEncoding, Name]
    32: [32, 32, 32, "space"],
    33: [33, 33, 33, "exclam"],
    34: [34, 34, 34, "quotedbl"],
    35: [35, 35, 35, "numbersign"],
    36: [36, 36, 36, "dollar"],
    37: [37, 37, 37, "percent"],
    38: [38, 38, 38, "ampersand"],
    39: [137, 39, 39, "quotesingle"],
    40: [40, 40, 40, "parenleft"],
    41: [41, 41, 41, "parenright"],
    42: [42, 42, 42, "asterisk"],
    43: [43, 43, 43, "plus"],
    44: [44, 44, 44, "comma"],
    45: [45, 45, 45, "hyphen"],
    46: [46, 46, 46, "period"],
    47: [47, 47, 47, "slash"],
    48: [48, 48, 48, "zero"],
    49: [49, 49, 49, "one"],
    50: [50, 50, 50, "two"],
    51: [51, 51, 51, "three"],
    52: [52, 52, 52, "four"],
    53: [53, 53, 53, "five"],
    54: [54, 54, 54, "six"],
    55: [55, 55, 55, "seven"],
    56: [56, 56, 56, "eight"],
    57: [57, 57, 57, "nine"],
    58: [58, 58, 58, "colon"],
    59: [59, 59, 59, "semicolon"],
    60: [60, 60, 60, "less"],
    61: [61, 61, 61, "equal"],
    62: [62, 62, 62, "greater"],
    63: [63, 63, 63, "question"],
    64: [64, 64, 64, "at"],
    65: [65, 65, 65, "A"],
    66: [66, 66, 66, "B"],
    67: [67, 67, 67, "C"],
    68: [68, 68, 68, "D"],
    69: [69, 69, 69, "E"],
    70: [70, 70, 70, "F"],
    71: [71, 71, 71, "G"],
    72: [72, 72, 72, "H"],
    73: [73, 73, 73, "I"],
    74: [74, 74, 74, "J"],
    75: [75, 75, 75, "K"],
    76: [76, 76, 76, "L"],
    77: [77, 77, 77, "M"],
    78: [78, 78, 78, "N"],
    79: [79, 79, 79, "O"],
    80: [80, 80, 80, "P"],
    81: [81, 81, 81, "Q"],
    82: [82, 82, 82, "R"],
    83: [83, 83, 83, "S"],
    84: [84, 84, 84, "T"],
    85: [85, 85, 85, "U"],
    86: [86, 86, 86, "V"],
    87: [87, 87, 87, "W"],
    88: [88, 88, 88, "X"],
    89: [89, 89, 89, "Y"],
    90: [90, 90, 90, "Z"],
    91: [91, 91, 91, "bracketleft"],
    92: [92, 92, 92, "backslash"],
    93: [93, 93, 93, "bracketright"],
    94: [94, 94, 94, "asciicircum"],
    95: [95, 95, 95, "underscore"],
    96: [161, 96, 96, "grave"],
    97: [97, 97, 97, "a"],
    98: [98, 98, 98, "b"],
    99: [99, 99, 99, "c"],
    100: [100, 100, 100, "d"],
    101: [101, 101, 101, "e"],
    102: [102, 102, 102, "f"],
    103: [103, 103, 103, "g"],
    104: [104, 104, 104, "h"],
    105: [105, 105, 105, "i"],
    106: [106, 106, 106, "j"],
    107: [107, 107, 107, "k"],
    108: [108, 108, 108, "l"],
    109: [109, 109, 109, "m"],
    110: [110, 110, 110, "n"],
    111: [111, 111, 111, "o"],
    112: [112, 112, 112, "p"],
    113: [113, 113, 113, "q"],
    114: [114, 114, 114, "r"],
    115: [115, 115, 115, "s"],
    116: [116, 116, 116, "t"],
    117: [117, 117, 117, "u"],
    118: [118, 118, 118, "v"],
    119: [119, 119, 119, "w"],
    120: [120, 120, 120, "x"],
    121: [121, 121, 121, "y"],
    122: [122, 122, 122, "z"],
    123: [123, 123, 123, "braceleft"],
    124: [124, 124, 124, "bar"],
    125: [125, 125, 125, "braceright"],
    126: [126, 126, 126, "asciitilde"],
    161: [129, 193, 161, "exclamdown"],
    162: [130, 162, 162, "cent"],
    163: [131, 163, 163, "sterling"],
    164: [136, 219, 164, "currency"],
    165: [133, 180, 165, "yen"],
    166: [, , 166, "brokenbar"],
    167: [135, 164, 167, "section"],
    168: [168, 172, 168, "dieresis"],
    169: [, 169, 169, "copyright"],
    170: [195, 187, 170, "ordfeminine"],
    171: [139, 199, 171, "guillemotleft"],
    172: [, 194, 172, "logicalnot"],
    174: [, 168, 174, "registered"],
    175: [165, 248, 175, "macron"],
    176: [, 161, 176, "degree"],
    177: [, 177, 177, "plusminus"],
    178: [, , 178, "twosuperior"],
    179: [, , 179, "threesuperior"],
    180: [162, 171, 180, "acute"],
    181: [, 181, 181, "mu"],
    182: [150, 166, 182, "paragraph"],
    183: [148, 225, 183, "periodcentered"],
    184: [171, 252, 184, "cedilla"],
    185: [, , 185, "onesuperior"],
    186: [203, 188, 186, "ordmasculine"],
    187: [155, 200, 187, "guillemotright"],
    188: [, , 188, "onequarter"],
    189: [, , 189, "onehalf"],
    190: [, , 190, "threequarters"],
    191: [159, 192, 191, "questiondown"],
    192: [, 203, 192, "Agrave"],
    193: [, 231, 193, "Aacute"],
    194: [, 229, 194, "Acircumflex"],
    195: [, 204, 195, "Atilde"],
    196: [, 128, 196, "Adieresis"],
    197: [, 129, 197, "Aring"],
    198: [193, 174, 198, "AE"],
    199: [, 130, 199, "Ccedilla"],
    200: [, 233, 200, "Egrave"],
    201: [, 131, 201, "Eacute"],
    202: [, 230, 202, "Ecircumflex"],
    203: [, 232, 203, "Edieresis"],
    204: [, 237, 204, "Igrave"],
    205: [, 234, 205, "Iacute"],
    206: [, 235, 206, "Icircumflex"],
    207: [, 236, 207, "Idieresis"],
    208: [, , 208, "Eth"],
    209: [, 132, 209, "Ntilde"],
    210: [, 241, 210, "Ograve"],
    211: [, 238, 211, "Oacute"],
    212: [, 239, 212, "Ocircumflex"],
    213: [, 205, 213, "Otilde"],
    214: [, 133, 214, "Odieresis"],
    215: [, , 215, "multiply"],
    216: [201, 175, 216, "Oslash"],
    217: [, 244, 217, "Ugrave"],
    218: [, 242, 218, "Uacute"],
    219: [, 243, 219, "Ucircumflex"],
    220: [, 134, 220, "Udieresis"],
    221: [, , 221, "Yacute"],
    222: [, , 222, "Thorn"],
    223: [219, 167, 223, "germandbls"],
    224: [, 136, 224, "agrave"],
    225: [, 135, 225, "aacute"],
    226: [, 137, 226, "acircumflex"],
    227: [, 139, 227, "atilde"],
    228: [, 138, 228, "adieresis"],
    229: [, 140, 229, "aring"],
    230: [209, 190, 230, "ae"],
    231: [, 141, 231, "ccedilla"],
    232: [, 143, 232, "egrave"],
    233: [, 142, 233, "eacute"],
    234: [, 144, 234, "ecircumflex"],
    235: [, 145, 235, "edieresis"],
    236: [, 147, 236, "igrave"],
    237: [, 146, 237, "iacute"],
    238: [, 148, 238, "icircumflex"],
    239: [, 149, 239, "idieresis"],
    240: [, , 240, "eth"],
    241: [, 150, 241, "ntilde"],
    242: [, 152, 242, "ograve"],
    243: [, 151, 243, "oacute"],
    244: [, 153, 244, "ocircumflex"],
    245: [, 155, 245, "otilde"],
    246: [, 154, 246, "odieresis"],
    247: [, 214, 247, "divide"],
    248: [217, 191, 248, "oslash"],
    249: [, 157, 249, "ugrave"],
    250: [, 156, 250, "uacute"],
    251: [, 158, 251, "ucircumflex"],
    252: [, 159, 252, "udieresis"],
    253: [, , 253, "yacute"],
    254: [, , 254, "thorn"],
    255: [, 216, 255, "ydieresis"],
    305: [213, 245, , "dotlessi"],
    321: [200, , , "Lslash"],
    322: [216, , , "lslash"],
    338: [202, 206, 140, "OE"],
    339: [218, 207, 156, "oe"],
    352: [, , 138, "Scaron"],
    353: [, , 154, "scaron"],
    376: [, 217, 159, "Ydieresis"],
    381: [, , 142, "Zcaron"],
    382: [, , 158, "zcaron"],
    402: [134, 196, 131, "florin"],
    710: [163, 246, 136, "circumflex"],
    711: [175, 255, , "caron"],
    728: [166, 249, , "breve"],
    729: [167, 250, , "dotaccent"],
    730: [170, 251, , "ring"],
    731: [174, 254, , "ogonek"],
    732: [164, 247, 152, "tilde"],
    733: [173, 253, , "hungarumlaut"],
    960: [, 185, , "pi"],
    8211: [145, 208, 150, "endash"],
    8212: [176, 209, 151, "emdash"],
    8216: [96, 212, 145, "quoteleft"],
    8217: [39, 213, 146, "quoteright"],
    8218: [152, 226, 130, "quotesinglbase"],
    8220: [138, 210, 147, "quotedblleft"],
    8221: [154, 211, 148, "quotedblright"],
    8222: [153, 227, 132, "quotedblbase"],
    8224: [146, 160, 134, "dagger"],
    8225: [147, 224, 135, "daggerdbl"],
    8226: [151, 165, 127, "bullet"],
    8230: [156, 201, 133, "ellipsis"],
    8240: [157, 228, 137, "perthousand"],
    8249: [140, 220, 139, "guilsinglleft"],
    8250: [141, 221, 155, "guilsinglright"],
    8260: [132, 218, , "fraction"],
    8364: [, , 128, "Euro"],
    8482: [, 170, 153, "trademark"],
    8486: [, 189, , "Omega"],
    8706: [, 182, , "partialdiff"],
    8710: [, 198, , "Delta"],
    8719: [, 184, , "product"],
    8721: [, 183, , "summation"],
    8730: [, 195, , "radical"],
    8734: [, 176, , "infinity"],
    8747: [, 186, , "integral"],
    8776: [, 197, , "approxequal"],
    8800: [, 173, , "notequal"],
    8804: [, 178, , "lessequal"],
    8805: [, 179, , "greaterequal"],
    9674: [, 215, , "lozenge"],
    63743: [, 240, , "apple"],
    64257: [142, 222, , "fi"],
    64258: [143, 223, , "fl"]
  };

  public static getIndex(unicode: number, encoding: TextEncodingEnum): number {
    for (const [index, row] of Object.entries(this.table)) {
      const value = row[encoding];
      if (value === unicode) {
        return parseInt(index, 10);
      }
    }

    return -1;
  }
}
